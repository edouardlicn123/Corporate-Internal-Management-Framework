酒店家具尺寸计算及海运费用管理系统  
DDP純運輸費用計算器（基加利版）模块开发计划书

当前日期：2026年2月10日  
模块名称：DDP純運輸費用計算器（基加利版）  
所属系统：酒店家具尺寸计算及海运费用管理系统  
开发范围：将用户提供的单文件 HTML 计算器原原本本还原为 Flask 项目中的一个前端页面

1. 目标

将用户提供的完整单文件 HTML 计算器（DDP Freight Calculator 2026 - Kigali, Rwanda）  
忠实还原为 Flask 项目中的一个独立前端页面。  

功能、交互、计算逻辑、输出格式、提示文案、按钮文字、费用明细表结构必须与原版 100% 一致。  
本次开发不增加、不删除、不修改任何原有功能和细节。

2. 页面基本信息

页面标题：DDP 純運輸費用計算器 2026（基加利版）  
副标题：2026.2 終極版｜項目名稱支援｜一鍵截圖下載｜完整中文注釋保留｜含FOB/CIF

包含的输入项：
- 项目名称（可中英文）
- 总货值 USD（仅用于计算保险与税）
- 柜数 40'HC
- 目的港（下拉选择：Mombasa (肯尼亚) / Dar es Salaam (坦桑尼亚)）
- 海运费 USD/柜（到目的港）
- 陆路运费 USD/柜（从港到基加利）
- 保险费率 %
- 关税率 %
- VAT %
- 额外征收率 %

包含的复选框（额外费用）：
- 熏蒸费 +150 USD/柜
- 滞期/滞柜费缓冲 +200 USD/柜
- 海关查验费预留 +250 USD/柜
- EAC原产地证书费 +120 USD/柜
- 单证修改/更正费预留 +150 USD/柜
- 过境费/过境税缓冲 +200/250 USD/柜（依港而定）

包含的操作按钮：
- 计算純運輸費用（主按钮）

包含的显示区域：
- 计算结果展示区（包含截图下载按钮）
- 项目名称 + 目的港信息
- 启用额外费用的提示
- 五个大色块：FOB 南沙、CIF 目的港、陆运及到港国费用、卢旺达税费、单柜最终含税 DDP、总价
- 可展开的完整费用明细表格（details + summary）

3. 必须完整保留的特性

计算逻辑：
- 中国端 FOB 费用（固定参数：佛山到南沙拖车、南沙港务费、出口报关、ENS申报、电放费、DHL快递）
- CIF 计算（货值/柜 + 海运费 + 保险费，保险基数为货值 + 总运费 × 110%）
- 陆运及到港国费用（陆路运费 + 港口杂费 + DO费 + 清关费 + 拖车头分离费 + 电力监装 + 勾选额外费用 + 过境缓冲）
- 卢旺达税费（额外征收 → 关税基数 → 关税 → VAT基数 → VAT）
- FOB（含货值 + 中国端费用）
- 最终单柜 DDP 含税价格 = FOB + 海运 + 陆运及到港国费用 + 保险 + 卢旺达税费
- 多柜总费用 = 单柜 DDP 含税 × 柜数

交互行为：
- 选择目的港时自动更新海运费和陆路运费的中值提示及默认值（Mombasa 3000/3000，Dar es Salaam 3500/3500）
- 点击“计算純運輸費用”后立即生成完整结果
- 显示五个主要费用大色块（FOB、CIF、陆运及到港国、税费、单柜DDP、总价）
- 支持启用/禁用各项额外费用并实时反映在结果中（过境费依港不同）
- 点击“截图此结果”按钮可使用 html2canvas 将结果区域下载为 PNG 文件（文件名包含项目名、基加利、柜数、时间戳）
- 可展开“完整费用明细”表格，显示所有费用分项、分类汇总及中英文说明
- 金额使用千位分隔符格式化（toLocaleString）

视觉与体验：
- 保留原有颜色方案（橙色 DDP、黄色总价）
- 保留费用分类的 section-header 样式
- 保留 note 提示块、表格样式、details/summary 交互
- 保留手机端响应式布局（viewport 已设置）
- 保留中英文双语标签与说明

4. 模板文件命名

模板文件名：ddp_kigali_calculator.html

5. 关于样式文件

原页面包含一行：
<link rel="stylesheet" href="style.css">

确认：
- 该 style.css 文件真实存在
- 继承系统设置

6. 验收标准

- 目的港切换时海运费和陆路运费的中值提示及默认值正确更新
- 全部输入项默认值与原版一致（货值 211201.71、柜数 1、海运费 3000、陆路 3000 等）
- 所有固定费用参数（P 对象）与原版完全相同
- 计算结果（FOB、CIF、陆运及到港国、税费、单柜 DDP 含税、总价）与原版相同
- 勾选不同额外费用后，结果正确增减对应金额（过境费依港不同）
- 截图下载功能正常，生成的文件名格式正确
- 展开费用明细表格后，所有分类、分项、汇总金额与原版一致
- 手机竖屏打开时无严重布局错位，操作流畅

7. 备注

本次开发范围仅限于：
将用户提供的 HTML 内容放入 ddp_kigali_calculator.html 模板，  
保留原有内联脚本与外部脚本引用（html2canvas），  
按原样保留 <link rel="stylesheet" href="style.css">，  
确保页面在 Flask 中能够正常渲染并完整实现原有功能。